<!doctype html>
<html class="no-js" lang="zxx">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>NetREx</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="manifest" href="site.webmanifest">
		<link rel="shortcut icon" type="image/x-icon" href="assets/img/favicon.ico">

		<!-- CSS here -->
            <link rel="stylesheet" href="assets/css/bootstrap.min.css">
            <link rel="stylesheet" href="assets/css/owl.carousel.min.css">
            <link rel="stylesheet" href="assets/css/flaticon.css">
            <link rel="stylesheet" href="assets/css/slicknav.css">
            <link rel="stylesheet" href="assets/css/animate.min.css">
            <link rel="stylesheet" href="assets/css/magnific-popup.css">
            <link rel="stylesheet" href="assets/css/fontawesome-all.min.css">
            <link rel="stylesheet" href="assets/css/themify-icons.css">
            <link rel="stylesheet" href="assets/css/slick.css">
            <link rel="stylesheet" href="assets/css/nice-select.css">
			<link rel="stylesheet" href="assets/css/style.css">

			<link rel="stylesheet" href="assets/js/DataTables/datatables.min.css">
   			<link rel="stylesheet" href="assets/js/DataTables/dataTables.bootstrap.min.css">
			<link rel="stylesheet" href="assets/js/DataTables/buttons.dataTables.min.css">

			<link rel="stylesheet" href="assets/css/custom.css">
			<link rel="stylesheet" href="assets/css/app.css">

			<script src='assets/js/jquery.min.js'></script>
			<script src='assets/js/lodash.min.js'></script>
			<script src='https://kit.fontawesome.com/a076d05399.js'></script>
			<script src="assets/js/global.js"></script>
   </head>
   <style>
	   .dt-buttons{
		   left:10%;
	   }
   </style>

   <body>
       
    <!-- Preloader Start -->
    <div id="preloader-active">
        <div class="preloader d-flex align-items-center justify-content-center">
            <div class="preloader-inner position-relative">
                <div class="preloader-circle"></div>
                <div class="preloader-img pere-text">
                    <!-- netrex -->
                    <img src="assets/img/logo/f1.png" alt="">
                </div>
            </div>
        </div>
    </div>
    <!-- Preloader Start -->

    <header>
        <!-- Header Start -->
       <div class="header-area header-transparrent ">
            <div class="main-header header-sticky">
                <div class="container">
                    <div class="row align-items-center">
                        <!-- Logo -->
                        <div class="col-xl-2 col-lg-2 col-md-2">
                            <div class="logo">
                                <a href="index.html"><img src="assets/img/logo/f1.png" alt="" style="width:130px"></a>
                            </div>
                        </div>
                        <div class="col-xl-10 col-lg-10 col-md-10">
                            <!-- Main-menu -->
                            <div class="main-menu f-right d-none d-lg-block">
                                <nav>
                                    <ul id="navigation">
                                        <li><a href="index.html">Home</a></li>
                                        <li><a href="query.html">Query</a>
                                        <li class="active"><a>Browse</a>
                                            <ul class="submenu">
                                                <li><a href="module.html">Module Wise</a></li>
                                                <li><a href="condition.html">Condition Wise</a></li>
                                                <li><a href="pathway.html">Pathway Wise</a></li>
                                            </ul>
                                        </li>
                                        <li><a href="dataset.html">Datasets</a></li>
                                        <li><a href="tutorial.pdf">Help</a></li>
                                        <li><a href="contact.html">Contact</a></li>
                                    </ul>
                                </nav>
                            </div>
                        </div>
                        <!-- Mobile Menu -->
                        <div class="col-12">
                            <div class="mobile_menu d-block d-lg-none"></div>
                        </div>
                    </div>
                </div>
            </div>
       </div>
        <!-- Header End -->
    </header>

    <main>
    <!-- Slider Area Start-->

	<div class="services-area" style="margin-bottom: -40px;">
	</div>
	<!-- Slider Area End-->

	<!-- Start Sample Area -->
	<section class="sample-text-area">
		<div class="container box_1170" id="module-viewer">
			<h3 class="text-heading">Browse Module-wise</h3>
				<p class="sample-text">
					Click “Module viewer” to view top 100 highly connected genes based on their within-module 
					connectivity. In this view, the size of the nodes correspond to its degree connectivity 
					while the colour represents the module colour. The table lists the node and edge attributes
					and function GO enrichment of these genes.
				</p>
				<br>
				<div>
					<form class="form-contact" action="/netrex/module" id="moduleForm">
						<div class="row">

							<div class="input-group-icon col-sm-3"><p style="font-weight: bold">Tissue : </p></div>
							<div class="input-group-icon col-sm-8">
								<div class="icon"><i class="fas fa-microscope" aria-hidden="true"></i></div>
								<div class="form-select" id="tissueHead">
									<select name="tissue" id="tissueM" required>
										<option value="root">Root</option>
										<option value="shoot">Shoot</option>
									</select>
								</div>
							</div>

							<div class="input-group-icon col-sm-3"><p style="font-weight: bold">Module : </p></div>
							<div class="input-group-icon col-sm-8">
								<div class="icon"><i class="fab fa-first-order-alt" aria-hidden="true"></i></div>
								<div class="form-select" id="moduleHead">
									<select name="module" id="module" required>
										<option value="black">Black</option>
									</select>
								</div>
							</div>
						</div>
						<div class="form-group mt-3">
							<button type="submit" class="button boxed-btn">Send</button>
						</div>
					</form>
				</div>

			<div class="container box_1170" id="loading-image" style="display: none;">
				<img src="assets/loading.gif" style="width: 70px;"><p>Please wait while data is being fetched. It'll take less than a minute...</p>
			</div>
			<p><button type="button" class="btn-outline-secondary" id="show-network" style="display: none;">Module Viewer</button></p>
			
			<!-- Start Table -->
			<div id="querytable" style="display: none;">
				<nav>
					<div class="nav nav-tabs" id="nav-tab" role="tablist">
					  <a class="nav-item nav-link active" id="nav-node-tab" data-toggle="tab" href="#nav-node" role="tab" aria-controls="nav-node" aria-selected="true">Nodes</a>
					  <a class="nav-item nav-link" id="nav-edge-tab" data-toggle="tab" href="#nav-edge" role="tab" aria-controls="nav-edge" aria-selected="false">Edges</a>
					  <a class="nav-item nav-link" id="nav-go-tab" data-toggle="tab" href="#nav-go" role="tab" aria-controls="nav-go" aria-selected="false">GO Enrichment</a>
					</div>
				</nav>
				<div class="tab-content" id="nav-tabContent">
					<div class="tab-pane fade show active" id="nav-node" role="tabpanel" aria-labelledby="nav-node-tab">
						<table id="data-table" class="display" style="width:100%">
							<thead><tr></tr></thead>
						</table>
					</div>
					<div class="tab-pane fade" id="nav-edge" role="tabpanel" aria-labelledby="nav-edge-tab">
						<table id="edge-table" class="display" style="width:100%">
							<thead><tr></tr></thead>
						</table>
					</div>
					<div class="tab-pane fade" id="nav-go" role="tabpanel" aria-labelledby="nav-go-tab">
						<table id="go-table" class="display" style="width:100%">
							<thead><tr></tr></thead>
						</table>
					</div>
				</div>
			</div>
			<!-- End Table -->

			
			<!-- Start Graph Area -->
			<div id="network-view" style="display: none;">
				<div class="row" style="margin:0px">
					
					<!-- Start Network Area -->
					<div class="col-lg-12 col-md-12"  id="network-graph"></div>
					<!-- End Network Area -->
					
					<!-- Start Network Options Area -->
					<div class="single-element-widget">
						<div class="button-group-area mt-40">
							<a id="downloadimg" class="genric-btn success circle">Download Image</a>
							<!-- <a href="#" class="genric-btn warning circle">Force Atlas</a> -->
						</div>
					</div>
					<!-- End Network Options Area -->
				</div>
			</div>
			<!-- End Graph Area -->
		</div>
	</section>
    <!-- End Sample Area -->

	<!-- JS here -->
	
		<!-- All JS Custom Plugins Link Here here -->
        <script src="./assets/js/vendor/modernizr-3.5.0.min.js"></script>
		
		<!-- Jquery, Popper, Bootstrap -->
		<script src="./assets/js/vendor/jquery-1.12.4.min.js"></script>
        <script src="./assets/js/popper.min.js"></script>
        <script src="./assets/js/bootstrap.min.js"></script>
	    <!-- Jquery Mobile Menu -->
        <script src="./assets/js/jquery.slicknav.min.js"></script>

		<!-- Jquery Slick , Owl-Carousel Plugins -->
        <script src="./assets/js/owl.carousel.min.js"></script>
		<script src="./assets/js/slick.min.js"></script>
		
		<!-- One Page, Animated-HeadLin -->
        <script src="./assets/js/wow.min.js"></script>
		<script src="./assets/js/animated.headline.js"></script>
		<script src="./assets/js/jquery.magnific-popup.js"></script>
		
		<!-- Scrollup, nice-select, sticky -->
        <script src="./assets/js/jquery.scrollUp.min.js"></script>
        <script src="./assets/js/jquery.nice-select.min.js"></script>
		<script src="./assets/js/jquery.sticky.js"></script>
        
        <!-- contact js -->
        <script src="./assets/js/contact.js"></script>
        <script src="./assets/js/jquery.form.js"></script>
        <script src="./assets/js/jquery.validate.min.js"></script>
        <script src="./assets/js/mail-script.js"></script>
		<script src="./assets/js/jquery.ajaxchimp.min.js"></script>
	</body>
        
	<!-- Jquery Plugins, main Jquery -->	
    <script src="./assets/js/plugins.js"></script>
	<script src="./assets/js/main.js"></script>

	<script src="./assets/js/helper.js"></script>

	<script src='./sigma/sigma.min.js'></script>
	<script src='./sigma/sigma.layout.forceAtlas2.min.js'></script>
	<script src='./sigma/sigma.plugins.filter.js'></script>
	<script src='./sigma/shape-library.js'></script>
	<script src='./sigma/sigma.renderers.customShapes.js'></script>
	<script src='./sigma/sigma.plugins.animate.js'></script>
	<script src='./sigma/sigma.layout.noverlap.js'></script>
	<script src="./sigma/sigma.renderers.snapshot.js"></script>
	<script src="./assets/js/load_graph.js"></script>

	<script src="./assets/js/DataTables/datatables.min.js"></script>
	<script src="./assets/js/DataTables/dataTables.buttons.min.js"></script>
	<script src="./assets/js/DataTables/buttons.colVis.min.js"></script>
	<script src="./assets/js/DataTables/buttons.html5.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/pdfmake.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/vfs_fonts.js "></script>
	<script src="./assets/js/load_module_table.js"></script>
		
	<!-- Personalised Scripts -->
	<script type="text/javascript">
		document.getElementById('moduleForm').action = deployment_url+'module';
		var graph;

		$("#moduleForm").submit(function(e) {
			$("#loading-image").show();
			e.preventDefault(); // avoid to execute the actual submit of the form.
			var form = $(this);
			var url = form.attr('action');
			$.ajax({
				type: "POST",
				url: url,
				data: form.serialize(),
				success: function (data) {
					console.log(data);
					$("#loading-image").hide();

					$('#network-graph').html('<span id="graph-title"></span><span class="fas fa-sync-alt" id="refresh" ></span>');
					$('#network-view').hide();
					$('#show-network').prop('disabled', false);
					
					if ($.fn.DataTable.isDataTable("#data-table")) {
						$('#data-table').DataTable().clear().destroy();
					};
					if ($.fn.DataTable.isDataTable("#edge-table")) {
					  $('#edge-table').DataTable().clear().destroy();
					};
					if ($.fn.DataTable.isDataTable("#go-table")) {
						$('#go-table').DataTable().clear().destroy();
					};
					$('#data-table').html('<thead><tr></tr></thead>');
					$('#edge-table').html('<thead><tr></tr></thead>');
					$('#go-table').html('<thead><tr></tr></thead>');
					
					$('#show-network').show();
					$('#querytable').show();
					
					graph = data;
					load_module_table(graph);
				},
				error: function(){
					alert('Error');
				}
			});
		});
		$(document).ready(()=>{
			$('#show-network').click(function(){
				$('#network-view').show();
				$('#graph-title').append($("#tissueM option:selected").text()+'<br>'+$("#module option:selected").text());
				$('#show-network').prop('disabled', true);
				load_graph(graph,'network-graph','',false);
				$('html, body').animate({
					scrollTop: $("#network-view").offset().top - 75
				}, 1000);
			});
			$(function(){
				var options = {
					'- Module Color -' : '',
				}
				$('#tissueM').change(function(){
					var data= $(this).val();
					var rootModules = {
						'Black' : 'black',
						'Blue' : 'blue',
						'Brown' : 'brown',
						'Cyan' : 'cyan',
						'Green' : 'green',
						'Green Yellow' : 'greenyellow',
						'Grey60' : 'grey60',
						'Light Cyan' : 'lightcyan',
						'Light Green' : 'lightgreen',
						'Light Yellow' : 'lightyellow',
						'Magenta' : 'magenta',
						'Midnight Blue' : 'midnightblue',
						'Pink' : 'pink',
						'Purple' : 'purple',
						'Red' : 'red',
						'Royal Blue' : 'royalblue',
						'Salmon' : 'salmon',
						'Tan' : 'tan',
						'Turquoise' : 'turquoise',
						'Yellow' : 'yellow',
					};
					var shootModules = {
						'Black' : 'black',
						'Blue' : 'blue',
						'Brown' : 'brown',
						'Cyan' : 'cyan',
						'Green' : 'green',
						'Green Yellow' : 'greenyellow',
						'Grey60' : 'grey60',
						'Light Cyan' : 'lightcyan',
						'Light Green' : 'lightgreen',
						'Magenta' : 'magenta',
						'Midnight Blue' : 'midnightblue',
						'Pink' : 'pink',
						'Purple' : 'purple',
						'Red' : 'red',
						'Royal Blue' : 'royalblue',
						'Salmon' : 'salmon',
						'Tan' : 'tan',
						'Turquoise' : 'turquoise',
						'Yellow' : 'yellow',
					};
					
					if(data == "root"){
						options = rootModules;
					}
					else if(data == "shoot"){
						options = shootModules;
					}

					var $el = $("#module");
					$el.empty(); // remove old options
					$.each(options, function(key,value) {
					  $el.append($("<option></option>")
					     .attr("value", value).text(key));
					});
					var $el = $("#moduleHead > div > ul");
					$el.empty(); // remove old options
					$.each(options, function(key,value) {
					  $el.append($("<li></li>")
					     .attr("data-value", value).attr("class", "option").text(key));
					});
				});
				$('#tissueM').trigger('change');

				var query = QueryStringToJSON();
				if(typeof query.tissue!== 'undefined'){
					$("#tissueM").val(query.tissue);
					var tissue = $( "#tissueM option:selected").text();
					$("#tissueHead > div > span").html(tissue);
					
					$('#tissueM').trigger('change');

					var module_val = query.module.replace(/\s+/g, '').toLowerCase();
					var module_key = Object.keys(options).find(key => options[key] === module_val);

					$("#module").val(module_val);
					$("#moduleHead > div > span").html(module_key);

					$("#moduleForm").submit();
				}
			});
		});
	</script>
</html>